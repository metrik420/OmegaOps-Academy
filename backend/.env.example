# =============================================================================
# OmegaOps Academy Backend Configuration
# =============================================================================
# Copy this file to .env and configure for your environment
# NEVER commit .env to version control - it contains secrets
# =============================================================================

# -----------------------------------------------------------------------------
# SERVER CONFIGURATION
# -----------------------------------------------------------------------------
# Port the Express server will listen on
# Default: 3001 (frontend typically on 3000)
PORT=3001

# Node environment: development | production | test
# Controls logging verbosity, error detail exposure, etc.
NODE_ENV=development

# Base URL for the API (used in self-referencing links)
API_BASE_URL=http://localhost:3001

# Frontend URL for CORS configuration
# In production, this should be your actual frontend domain
FRONTEND_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# -----------------------------------------------------------------------------
# SQLite database file path (relative to project root)
# In production, use an absolute path on persistent storage
DATABASE_PATH=./data/omegaops.db

# Enable SQLite WAL mode for better concurrent read performance
# Recommended: true for production
DATABASE_WAL_MODE=true

# -----------------------------------------------------------------------------
# SECURITY CONFIGURATION
# -----------------------------------------------------------------------------
# Admin credentials for protected endpoints
# CRITICAL: Change these in production!
# Use strong, unique passwords (min 16 chars, mixed case, numbers, symbols)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=CHANGE_ME_IN_PRODUCTION_MIN_16_CHARS

# Session secret for cookie signing (if sessions are implemented)
# Generate with: openssl rand -base64 32
SESSION_SECRET=your-session-secret-here-change-in-production

# =============================================================================
# AUTHENTICATION & JWT CONFIGURATION
# =============================================================================
# JWT Secret (REQUIRED - CHANGE THIS!)
# Generate with: openssl rand -base64 32
# Must be 32+ characters, random, and kept secret
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production-make-it-long

# JWT Expiration Times
JWT_EXPIRATION=15m                    # Access token: 15 minutes
REFRESH_TOKEN_EXPIRATION=7d           # Refresh token: 7 days
RESET_TOKEN_EXPIRATION=1h             # Password reset: 1 hour
VERIFICATION_TOKEN_EXPIRATION=1h      # Email verification: 1 hour

# Account Security
MAX_FAILED_LOGIN_ATTEMPTS=5           # Lock account after 5 failed attempts
LOCKOUT_DURATION_MINUTES=15           # Lock duration: 15 minutes
BCRYPT_ROUNDS=12                      # bcrypt cost factor (~250ms)

# Admin Credentials (seeded automatically)
# DEFAULT PASSWORD: Cooldog420
# SECURITY: Change immediately after first login!
ADMIN_USERNAME=metrik
ADMIN_EMAIL=metrikcorp@gmail.com

# =============================================================================
# EMAIL SERVICE (SMTP)
# =============================================================================
# SMTP Server Configuration
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=your-email@gmail.com
EMAIL_PASSWORD=your-app-specific-password
EMAIL_FROM=noreply@omegaops.academy
EMAIL_FROM_NAME=OmegaOps Academy

# =============================================================================
# RATE LIMITING
# =============================================================================
# Auth endpoints: 5 requests per 15 minutes
# Password reset: 3 requests per hour
# API endpoints: 100 requests per 15 minutes
RATE_LIMIT_AUTH_MAX=5
RATE_LIMIT_AUTH_WINDOW=15
RATE_LIMIT_RESET_MAX=3
RATE_LIMIT_RESET_WINDOW=60
RATE_LIMIT_API_MAX=100
RATE_LIMIT_API_WINDOW=15

# JWT secret (for future token-based auth)
# Generate with: openssl rand -base64 64
JWT_SECRET=your-jwt-secret-here-change-in-production

# JWT expiration time
JWT_EXPIRES_IN=24h

# -----------------------------------------------------------------------------
# CORS CONFIGURATION
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins for CORS
# In production, be specific: https://academy.example.com
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Whether to allow credentials (cookies, auth headers) in CORS requests
CORS_ALLOW_CREDENTIALS=true

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# -----------------------------------------------------------------------------
# Log level: error | warn | info | http | verbose | debug | silly
LOG_LEVEL=info

# Log format: json | simple | combined
# json: structured logs for production (easy to parse)
# simple: human-readable for development
LOG_FORMAT=simple

# Log file path (logs are written here in addition to console)
LOG_FILE_PATH=./logs/app.log

# Maximum log file size before rotation (in bytes)
# 10MB = 10485760
LOG_MAX_SIZE=10485760

# Number of rotated log files to keep
LOG_MAX_FILES=5

# -----------------------------------------------------------------------------
# WORKER CONFIGURATION
# -----------------------------------------------------------------------------
# How often workers should run (cron syntax)
# Knowledge worker: Check for documentation updates
KNOWLEDGE_WORKER_SCHEDULE=0 2 * * *

# Software discovery worker: Find new tools
SOFTWARE_DISCOVERY_WORKER_SCHEDULE=0 3 * * 0

# Software documentation worker: Generate install guides
SOFTWARE_DOC_WORKER_SCHEDULE=0 4 * * *

# External API endpoints for workers (placeholders for MVP)
# These would be real URLs in production
GITHUB_API_BASE=https://api.github.com
DOCKER_HUB_API_BASE=https://hub.docker.com/v2

# Rate limiting for external API calls (requests per minute)
EXTERNAL_API_RATE_LIMIT=30

# -----------------------------------------------------------------------------
# CONTENT CONFIGURATION
# -----------------------------------------------------------------------------
# Default confidence level for new content
DEFAULT_CONFIDENCE_LEVEL=medium

# Auto-approve updates from trusted sources
AUTO_APPROVE_TRUSTED_SOURCES=false

# Trusted source URLs (comma-separated)
TRUSTED_SOURCES=https://docs.docker.com,https://nginx.org/en/docs/

# -----------------------------------------------------------------------------
# PERFORMANCE CONFIGURATION
# -----------------------------------------------------------------------------
# Request timeout in milliseconds
REQUEST_TIMEOUT_MS=30000

# Maximum request body size
MAX_REQUEST_SIZE=10mb

# Enable response compression
ENABLE_COMPRESSION=true

# Cache TTL for static data (seconds)
# 3600 = 1 hour
CACHE_TTL_SECONDS=3600

# -----------------------------------------------------------------------------
# DEVELOPMENT ONLY
# -----------------------------------------------------------------------------
# Enable detailed error stack traces in responses (NEVER in production)
EXPOSE_ERROR_STACK=false

# Enable request/response logging (verbose, affects performance)
ENABLE_REQUEST_LOGGING=true

# Seed database with sample data on startup
SEED_DATABASE_ON_STARTUP=true
